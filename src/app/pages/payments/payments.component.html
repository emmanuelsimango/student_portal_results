<div class="row">
	<div class="mx-auto col-lg-8 col-md-8 col-sm-12">
		<div class="card card-chart rounded-0">
			<div class="card-header bg-primary rounded-0">
				<h4 class="font-weight-bold">Make a payment</h4>
			</div>
			<div class="px-3 card-body">
				<form
					#paymentForm="ngForm"
					[ngClass]="amount.touched ? 'was-validated' : ''"
					autocomplete="off"
					(submit)="onSubmit(paymentForm,alert)"
				>
					<div class="form-group">
						<label for="email">Email</label>
						<input
						autofocus
							type="email"
							class="form-control"
							name="email"
							id="email"
							[ngClass]="{
								'is-invalid': amount.touched && amount.errors
							}"
							placeholder="Email"
							ngModel="email"
							#email="ngModel"
							required
						/>
						<small
							[hidden]="!email.errors?.required"
							class="invalid-feedback small"
						>
							Email is required
						</small>
						<div class="invalid-feedback small" [hidden]="!email.errors?.email">
							Pin should be a minimum of four digits
						</div>
						<!-- <small id="emailHelpId" class="form-text text-muted">Help text</small> -->
					</div>
					<div class="form-group">
						<label for="amount">Amount(ZWL$)</label>
						<input
							type="number"
							class="form-control"
							name="amount"
							id="amount"
							placeholder="Amount"

							pattern="[0-9]*"
							[ngClass]="{
								'is-invalid': amount.touched && amount.errors
							}"
							placeholder="0.0"
							minlength="3"
							maxlength="10"
							ngModel="amount"
							#amount="ngModel"
							required
						/>
						<div
							[hidden]="!amount.errors?.required"
							class="invalid-feedback small"
						>
							Amount is required
						</div>
						<!-- <small id="helpId" class="form-text text-muted">Help text</small> -->
					</div>
					<div class="form-group">
						<label for="amount">Payment Description</label>
						<select
							name="description"
							id="description"
							class="form-control"
							[ngClass]="{
								'is-invalid': description.touched && description.errors
							}"
							[ngModel]="description"
							#description="ngModel"
							required

						>
							<option *ngFor="let item of payment_codes;let i=index" [value]="item.payment_code"  >
								{{ item.description }}
							</option>
						</select>
						<div
							[hidden]="!description.errors?.required"
							class="invalid-feedback small"
						>
							Description
						</div>
						<!-- <small id="helpId" class="form-text text-muted">Help text</small> -->
					</div>

					<div class="row">
						<button  [disabled]="!paymentForm.valid "
						 type="submit" class="mx-auto btn btn-link">
							<img
								src="assets\img\button_make-payment_large.svg"
								alt=""
							/>
						</button>
					</div>
				</form>
				<hr />
				<img
					src="https://developers.paynow.co.zw/docs/assets/Paynow%20Badge-vector-hires%20DARK.svg"
				/>

				<p>
					Paynow is a secure online payments gateway. Click
					<a
						href="https://www.paynow.co.zw/Home/AboutUs"
						target="_blank"
						rel="noopener noreferrer"
						>here</a
					>
					for more information about Paynow.
				</p>
				<hr />
				<!-- <a href='https://www.paynow.co.zw/Payment/Link/?q=c2VhcmNoPWVtbWFudWVsc2ltYW5nbyU0MGdtYWlsLmNvbSZhbW91bnQ9MC4wMCZyZWZlcmVuY2U9Jmw9MA%3d%3d' target='_blank'><img src='https://www.paynow.co.zw/Content/Buttons/Medium_buttons/button_pay-now_medium.png' style='border:0' /></a> -->
			</div>
		</div>
	</div>
	<div class="col-lg-4 col-md-4 col-sm-12">
		<div class="card card-chart">
			<div class="px-4 card-header">
				<!-- <div class="form-group">
					<label for="">Search Transaction</label>
					<div class="mb-3 input-group">
						<input
							type="text"
							class="form-control"
							placeholder="Transaction Reference Number"
							aria-label="Transaction Reference Number"
							aria-describedby="basic-addon2"
						/>
						<div class="input-group-append">
							<button
								type=""
								class="py-1 btn btn-outline-light btn-link"
							>
								Search
							</button>
						</div>
					</div>
				</div> -->
			</div>
			<div class="px-3 card-body">
				<table class="table">
					<tr>
						<th>Date</th>
						<th>Description</th>
						<th>Action</th>
					</tr>
					<tr class="small" *ngFor="let payment of payments">
						<td>
							{{ payment.created_at | date }}
						</td>
						<td>
							{{ payment.payment_description }}
							<span
								class="float-right badge badge-pill small font-weight-bold text-dark"
								[ngClass]="{
									'badge-success': payment.confirmed,
									'badge-warning': !payment.confirmed
								}"
							>
								{{ payment.confirmed ? "success" : "pending" }}
							</span>
						</td>
						<td>
							<button
								class="btn btn-link"
								*ngIf="payment.confirmed"
								type="button"
							>
								<i
									class="tim-icons icon-check-2 text-success-states"
								>
								</i>
							</button>

							<button
								class="cursor-pointer badge badge-light badge-pill small text-dark font-weight-bold"
								*ngIf="!payment.confirmed"
								type="button"
								(click)="pollTransaction(payment,alert)"
							>
								check
								<i
									class="tim-icons icon-alert-circle-exc text-danger-states"
								>
								</i>
							</button>
						</td>
					</tr>
				</table>
			</div>
		</div>
	</div>
</div>

<ng-template #alert let-modal>
	<div class="modal-header bg-info">
		<h4 class="text-center" id="" style="color: white !important">
			Information <i class="fas fa-exclamation"></i>
		</h4>
		<button
			type="button"
			class="close"
			aria-label="Close"
			(click)="modal.dismiss('Cross click')"
		>
			<span aria-hidden="true">Ã—</span>
		</button>
	</div>
	<div class="modal-body">
		{{ msg }}
	</div>
	<div class="modal-footer justify-content-end">
		<button
			type="button"
			class="btn btn-primary"
			(click)="modal.close('Save click')"
		>
			Okay
		</button>
	</div>
</ng-template>
